计算机网络

# 第6章 应用层

每个应用层协议都是为了解决某一类应用问题，而问题的解决又必须**通过位于不同主机中恶多个应用进程之间的通信和协同工作来完成**。应用进程之间的这种通信必须遵循严格的规则。应用层的具体内容就是精确**定义这些通信规则**，应用层协议应当定义：

- 应用进程交换的报文类型，如请求报文和相应报文。
- 各种报文类型的语法，如报文中的各个字段及其详细描述
- 字段的语义，即包含在字段中的信息的含义
- 进程何时，如何发送报文，以及对报文进行相应的规则

应用层的许多协议都是基于**客户服务器方式**，即使是P2P对等通信方式，实质上也是一种特殊的客户服务器方式。**客户**和**服务器**都是指通信中所涉及的两个**应用进程**。客户服务器方式所描述的是进程之间服务和被服务的关系。这里最主要的特征就是：**客户是服务请求方，服务器是服务提供方**

## 6.1 域名系统DNS

### 6.1.1 域名系统概述

**域名系统DNS**是互联网使用的命名系统，用来把便于人们使用的机器名字转换为IP地址。

互联网的域名系统DNS被设计成为一个联机分布式数据库系统，并采用客户服务器方式。DNS使大多数名字都在本地进行**解析**，仅少量解析需要在互联网上通信，因此DNS系统效率很高。

域名到IP地址的解析过程的要点如下：当某一个应用进程需要把主机名解析为IP地址时，该应用进程就调用**解析程序**，并成为DNS的一个客户，把待解析的域名放在DNS的请求报文中，以UDP用户数据报的方式发送给本地域名服务器（使用UDP是为了减小开销）。本地域名服务器在查找域名后，把对应的IP地址放在回答报文中返回。应用进程获得目的主机的IP地址后即可进行通信。

若本地域名服务器不能回答该请求，则此域名服务器就暂时成为DNS中的另一个客户，并向其他域名服务器发出查询请求，直至找到能够回答该请求的域名服务器为止。

### 6.1.2 互联网的域名结构

任何一个连接在互联网上的主机或路由器，都有一个唯一**的层次结构的名字**，即域名，这里，“域“是名字空间中一个可被管理的划分。域还可以划分为子域，子域可以划分为子域的子域，这样就形成了顶级域，二级域，三级域，等

DNS规定，域名中的标号都由英文字母和数字组成，**每一个标号不超过63个字符**，**也不区分大小写字母**。标号中除连字符-外不能使用其他的标点符号。级别最低的域名写在最左边，级别最高的写在最右边。**由多个标号组成的完整域名总共不超过255个字符**，各级域名由其上一级的域名管理机构管理，而最高域名则由ICANN进行管理。

原先的顶级域名共分为三大类：

- **国家顶级域名nTLD**
- **通用顶级域名gTLD**
- **基础结构域名**

### 6.1.3 域名服务器

一个服务器所管辖的范围叫做**区**。每一个区设置相应的**权限域名服务器**，用来保存该区中的所有主机的域名到IP地址的映射。总之，DNS服务器的管辖范围不是以”域“为单位，而是以”区“为单位。区是DNS服务器实际管辖的范围，区可能等于或小于域，但一定不能大于域。

可以把域名服务器划分为以下四种不同的类型：

- **根域名服务器**
- **顶级域名服务器**
- **权限域名服务器** 负责一个区的域名服务器，当一个权限域名服务器还不能给出最后的查询回答时，就会告诉发出查询请求的DNS客户，下一步应当找哪一个权限域名服务器。
- **本地域名服务器** 离用户较近，一般不超过几个路由器的距离。

为了提高域名服务器的可靠性，DNS域名服务器都把数据复制到几个域名服务器来保存，其中一个是**主域名服务器**，其他的都是**辅助域名服务器**

简单讨论下域名的解析过程

- 主机向本地域名服务器的查村一般都是采用**递归查询**
- 本地域名服务器向根域名服务器的查询通常是**迭代查询**

## 6.2 文件传送协议

### 6.2.1 FTP协议

**文件传送协议FTP**是互联网上使用的最广泛的文件传送协议。

下面的6.2.2和6.2.3节分别介绍基于TCP的FTP和基于UDP的简单文件传送协议TFTP，它们都是文件共享协议中的一大类，即**复制整个文件**，特点是：若要存取一个文件，就必须先获得一个本地的文件副本，如果要修改文件，只能对文件的副本进行修改，然后将修改后的文件副本传回到原节点。

文件共享协议的另一大类是**联机访问**

### 6.2.2 FTP的基本工作原理

FTP使用客户服务器方式。一个FTP服务器进程可同时为多个客户提供服务。FTP的服务器进程由两大部分组成：一个**主进程**，负责接受新的请求；另外有若干个**从属进程**，负责处理单个请求。

在进行文件传输时，FTP的客户和服务器之间要建立两个并行的TCP连接：**控制连接**和**数据连接**。控制连接在整个绘画期间一直保持打开，FTP客户所发出的传送请求，通过控制连接发送给服务器段的控制进程，但控制连接并不用来传送文件。**实际用于传输文件的是数据连接**

### 6.2.3 简单文件传送协议TFTP

TCP/IP协议族中还有一个**简单文件传送协议TFTP**，它是一个很小且易于实现的文件传送协议。

## 6.3 远程终端协议TELNET

TELNET是一个简单的远程终端协议，它也是互联网的正式标准。

## 6.4 万维网WWW

### 6.4.1 万维网概述

**万维网WWW**并非某种特殊的计算机网络。**万维网是一个大规模的，联机式的信息储藏所**，英文简称为Web。万维网使用链接的方法能非常方便地从互联网的一个站点访问另一个站点，从而主动的按需获取丰富的信息。

万维网是一个分布式的**超媒体**系统，它是**超文本**系统的扩充。

万维网以客户服务器方式工作。浏览器就是在用户主机上的万维网客户程序，万维网文档所驻留的主机则运行服务器程序，因此这台主机也称为万维网服务器。**客户程序向服务器发送请求，服务器程序向客户程序送回客户所要的万维网文档**。

- 万维网使用**统一资源定位符URL**来标志万维网上的各种文档，并使每一个文档在整个互联网的范围内具有唯一地标识符URL
- 万维网客户程序域服务器程序之间的交互遵循严格的协议---**超文本传送协议HTTP**。HTTP是一个应用层协议，它使用TCP进行可靠的传送
- 万维网使用**超文本标记语言HTML**

### 6.4.2 统一资源定位符URL

#### 1.URL的格式